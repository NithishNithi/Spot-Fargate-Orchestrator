# Example showing different per-deployment configurations
# This demonstrates how global config.toml settings can be overridden per deployment

---
# HIGH PRIORITY APP - Fast recovery, allows Fargate
apiVersion: apps/v1
kind: Deployment
metadata:
  name: critical-api
  namespace: production
  annotations:
    # üéØ OPT-IN: Enable orchestrator management
    spot-orchestrator/enabled: "true"
    
    # ‚ö° FAST RECOVERY: Override global 45m cooldown with 15m
    spot-orchestrator/recovery-cooldown: "15m"
    
    # ‚úÖ ALLOW FARGATE: Explicitly allow expensive Fargate migration
    spot-orchestrator/allow-fargate: "true"
    
    # ‚è±Ô∏è FAST ROLLOUT: Override global 120s timeout with 60s
    spot-orchestrator/rollout-timeout: "60s"
spec:
  replicas: 3
  selector:
    matchLabels:
      app: critical-api
  template:
    metadata:
      labels:
        app: critical-api
        compute-type: spot
    spec:
      containers:
      - name: api
        image: critical-api:latest
        ports:
        - containerPort: 8080

---
# BATCH PROCESSING APP - Spot-only, no Fargate
apiVersion: apps/v1
kind: Deployment
metadata:
  name: batch-processor
  namespace: production
  annotations:
    # üéØ OPT-IN: Enable orchestrator management
    spot-orchestrator/enabled: "true"
    
    # üí∞ SPOT-ONLY: Never migrate to expensive Fargate
    spot-orchestrator/allow-fargate: "false"
    
    # ‚ùå DISABLE RECOVERY: This app doesn't need recovery
    spot-orchestrator/recovery-enabled: "false"
spec:
  replicas: 5
  selector:
    matchLabels:
      app: batch-processor
  template:
    metadata:
      labels:
        app: batch-processor
        compute-type: spot
    spec:
      containers:
      - name: processor
        image: batch-processor:latest

---
# STANDARD WEB APP - Uses global config with minor tweaks
apiVersion: apps/v1
kind: Deployment
metadata:
  name: web-frontend
  namespace: production
  annotations:
    # üéØ OPT-IN: Enable orchestrator management
    spot-orchestrator/enabled: "true"
    
    # üïê SLOW RECOVERY: Override global 45m cooldown with 2h
    spot-orchestrator/recovery-cooldown: "2h"
    
    # üîç LONGER VERIFICATION: Wait 30s before verifying migration
    spot-orchestrator/verification-delay: "30s"
    
    # All other settings use global config.toml defaults:
    # - allow-fargate: true (default)
    # - recovery-enabled: true (default)
    # - rollout-timeout: 120s (global config)
spec:
  replicas: 2
  selector:
    matchLabels:
      app: web-frontend
  template:
    metadata:
      labels:
        app: web-frontend
        compute-type: spot
    spec:
      containers:
      - name: frontend
        image: web-frontend:latest
        ports:
        - containerPort: 3000

---
# UNMANAGED APP - No orchestrator management
apiVersion: apps/v1
kind: Deployment
metadata:
  name: legacy-app
  namespace: production
  # ‚ùå NO OPT-IN: This app is not managed by orchestrator
  # No spot-orchestrator/enabled annotation = ignored
spec:
  replicas: 1
  selector:
    matchLabels:
      app: legacy-app
  template:
    metadata:
      labels:
        app: legacy-app
        compute-type: spot
    spec:
      containers:
      - name: legacy
        image: legacy-app:latest